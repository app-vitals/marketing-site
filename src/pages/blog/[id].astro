---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { id: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);

const categoryColors: Record<string, string> = {
  'AI Adoption': 'text-accent-cyan border-accent-cyan/30',
  'Engineering Velocity': 'text-electric-400 border-electric-400/30',
  'Technical Leadership': 'text-accent-violet border-accent-violet/30',
  'Company Updates': 'text-electric-300 border-electric-300/30',
};
---

<BaseLayout title={`${post.data.title} — App Vitals`} description={post.data.excerpt}>
  <article class="py-24 md:py-32">
    <div class="max-w-3xl mx-auto px-6">
      <!-- Header -->
      <header class="mb-12 reveal">
        <a href="/blog" class="inline-flex items-center gap-2 font-mono text-[13px] text-white/40 hover:text-white/60 transition-colors mb-8 group">
          <svg class="w-4 h-4 group-hover:-translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" /></svg>
          All posts
        </a>
        <div class="flex flex-wrap items-center gap-3 mb-4">
          <span class={`font-mono text-[11px] tracking-widest uppercase px-2.5 py-1 rounded-full border ${categoryColors[post.data.category] || 'text-white/50 border-white/10'}`}>
            {post.data.category}
          </span>
          <span class="font-mono text-[12px] text-white/30">
            {new Date(post.data.date).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
          </span>
          <span class="font-mono text-[12px] text-white/30">·</span>
          <span class="font-mono text-[12px] text-white/30">{post.data.readTime}</span>
        </div>
        <h1 class="font-display text-3xl md:text-[42px] font-bold tracking-tight leading-[1.15] mb-4">
          {post.data.title}
        </h1>
        <p class="font-mono text-[13px] text-white/40">By {post.data.author}</p>
      </header>

      <!-- Content -->
      <div class="prose reveal">
        <Content />
      </div>

      <!-- CTA -->
      <div class="mt-16 pt-12 border-t border-white/[0.06] reveal">
        <div class="text-center">
          <p class="font-display text-xl md:text-2xl font-semibold mb-3">Want to accelerate your engineering team?</p>
          <p class="text-white/40 mb-6 text-[15px]">Book a 30-minute discovery call to discuss your team's AI adoption strategy.</p>
          <a
            href="/contact"
            class="inline-flex px-8 py-3.5 bg-white text-navy-950 hover:bg-white/90 rounded-full transition-all duration-300 font-semibold text-[15px] hover:shadow-[0_0_24px_rgba(59,130,246,0.25)]"
          >
            Get in Touch
          </a>
        </div>
      </div>
    </div>
  </article>
</BaseLayout>

<style is:global>
  .prose {
    @apply text-white/50 text-[16px] leading-[1.8];
  }
  .prose h2 {
    @apply font-display text-xl md:text-2xl font-semibold text-white mt-12 mb-4 tracking-tight;
  }
  .prose h3 {
    @apply font-display text-lg font-semibold text-white mt-10 mb-3 tracking-tight;
  }
  .prose p {
    @apply mb-6;
  }
  .prose strong {
    @apply text-white/70 font-medium;
  }
  .prose a {
    @apply text-electric-400 hover:text-electric-300 underline underline-offset-2 transition-colors;
  }
  .prose ul, .prose ol {
    @apply mb-6 pl-6 space-y-2;
  }
  .prose ul {
    @apply list-disc;
  }
  .prose ol {
    @apply list-decimal;
  }
  .prose li {
    @apply text-white/50;
  }
  .prose blockquote {
    @apply border-l-2 border-electric-500/40 pl-6 my-8 italic text-white/40;
  }
  .prose code {
    @apply font-mono text-[14px] bg-navy-800/60 text-electric-300 px-1.5 py-0.5 rounded;
  }
  .prose pre {
    @apply bg-navy-900 border border-white/[0.06] rounded-xl p-6 mb-6 overflow-x-auto;
  }
  .prose pre code {
    @apply bg-transparent p-0;
  }
  .prose hr {
    @apply border-white/[0.06] my-10;
  }
</style>
